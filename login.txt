IDENTIFIACTION DIVSION.
PROFRAM-ID. LOGIN.
ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
	SELECT LOGIN-FILE FROM LOGIN
        	ACCESS MODE IS INDEXED
		ORGANIZATION IS RANDOM.
DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-DETAILS
	02 WS-ID      PIC X(08).
	02 WS-PASS    PIC X(08).
PROCEDURE DIVISION.
	MAIN-PARA-1.
		IF EIBCALEN = 0
			PERFORM RETURN-PARA
		ELSE
			PERFORM NEXT-PARA
		END-IF.
	END-PARA.
		EXEC CICS RETURN
			TRANSID('P10_')
			COMMONAREA(______)
		END EXEC.
	NEXT-PARA.
		OPEN INPUT LOGIN-FILE
		IF WS-CA = 1
			PERFORM RECEIVE -PARA-2
			MOVE CUEXI TO  WS-ID
			MOVE PASSWEXI TO WS-PASS
		        PERFORM READ-PARA
		ELSE
			PERFORM REGISTER-PARA
		END-IF.	
	READ-PARA.
		READ LOGIN-FILE
			KEY IS WS-DETAILS
				INVALID KEY
					MOVE 'INVALID DETAILS' TO MESSEXO
					PERFORM SEND-PARA-2
				NOT INVALID KEY 
					PERFORM LOGIN-PARA
		END-READ. 
	SEND-PARA-2
		EXEC CICS SEND
			MAP(_____)
			MAPSET(_______)
			FROM(________)
		END-EXEC.
	LOGIN-PARA.
		EXEC CICS XCTL
			  PROGRAM(_________)
			  COMMONAREA(_________)
		END-EXEC
	REGISTER-PARA
		PERFORM RECEIVE-PARA-11
		MOVE PASSNWI TO WS-PASS
                MOVE CUNWI TO WS-ID , T-ID
		MOVE NAMENWI TO T-NAME
		MOVE GENNWI TO T-GEN
		MOVE DDNWI TO T-DOB-DD
		MOVE MMNWI TO T-DOB-MM
 		MOVE YYNWI TO T-DOB-YY
		MOVE PHNW TO T-PHONE
		MOVE NAMENNW TO T-NAME-NOM
		MOVE DDNNWI TO T-DOB-NOM-DD
		MOVE MMNNWI TO T-DOB-NOM-MM
		MOVE YYNNWI TO T-DOB-NOM-YY
		MOVE GENNNWI TO T-GEN-NOM
		MOVE RELNNWI TO T-RELATION
		MOVE PHNNWI  TO T-PHONE-NOM
		(PERFORM VALIDATE-PARA)
		IF WS-CHECK = 1
			PERFORM SQL-PARA
		ELSE
			MOVE ' ENTER VALID DETAILS ' TO MESSNWO
			PERFORM SEND-PARA-11
		END-IF.
	SQL-PARA.
		EXEC SQL
			INSERT INTO T10_CUSTOMER-TABLE
				VALUES(:T-RECORDS)
		END-EXEC.